@model Tuple<BeYeuBookstore.Application.ViewModels.BookViewModel, List<BeYeuBookstore.Application.ViewModels.RatingDetailViewModel>>
@using BeYeuBookstore.Extensions;
@inject Microsoft.AspNetCore.Http.IHttpContextAccessor HttpContextAccessor

@{
    ViewData["Title"] = "BookDetail";
    Layout = "~/Views/Shared/Frontend/_Layout.cshtml";
}

<!-- product-main-area-start -->
<div class="product-main-area mb-70" style="margin-top:15px;">
    <div class="container">
        <div class="row">
            <div class="col-lg-9 col-md-9 col-sm-8 col-xs-12">
                <!-- product-main-area-start -->
                <div class="product-main-area">
                    <div class="row">
                        <div class="col-lg-5 col-md-5 col-sm-6 col-xs-12">
                            <div class="flexslider">
                                <ul class="slides">
                                    <li data-thumb="img/thum-2/1.jpg">
                                        <img src="@Model.Item1.Img" alt="@Model.Item1.BookTitle" />
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="col-lg-7 col-md-7 col-sm-6 col-xs-12">
                            <div class="product-info-main">
                                <div class="page-title">
                                    <h1>@Model.Item1.BookTitle</h1>
                                </div>
                                <div class="product-info-stock-sku">
                                    <span>
                                        @{
                                            var quantity = Model.Item1.Quantity;
                                            Write((quantity > 0) ? "Còn hàng" : "Hết hàng");
                                        }
                                    </span>
                                    <div class="product-attribute">
                                        <p>Tác giả: @Model.Item1.Author</p>
                                    </div>
                                </div>
                                <div class="product-reviews-summary">
                                    <div class="rating-summary">
                                        <a href="#">@Model.Item1.Rating<i class="fa fa-star"></i></a>
                                    </div>
                                    <div class="reviews-actions">
                                        <a href="#">@Model.Item1.RatingNumber Nhận xét</a>
                                    </div>
                                </div>
                                <div class="product-info-price">
                                    <div class="price-final">
                                        <span class="money">
                                            @{
                                                var unitPrice = Convert.ToInt32(Model.Item1.UnitPrice);
                                                Write(unitPrice);
                                        }
                                    </span>
                                </div>
                            </div>
                            @if (quantity > 0)
                            {
                                <div class="product-add-form">
                                    <form onsubmit="return false">
                                        <a href="#">Thêm vào giỏ hàng</a>
                                    </form>
                                </div>
                            }
                            else
                            {
                                <p>Sản phẩm này đã hết hàng</p>
                            }

                            <div class="product-social-links">
                                <div class="product-addto-links-text">
                                    <p>@Model.Item1.Description</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- product-main-area-end -->
            <!-- product-info-area-start -->
            <div class="product-info-area mt-80">
                <!-- Nav tabs -->
                <ul class="nav nav-tabs" role="tablist">
                    <li class="active"><a href="#Details" data-toggle="tab">Chi tiết</a></li>
                    <li><a href="#Reviews" data-toggle="tab">Nhận xét</a></li>
                </ul>
                <div class="tab-content">
                    <div class="tab-pane active" id="Details">
                        <div class="valu">
                            <ul>
                                <li><i class="fa fa-circle"></i>Số trang: @Model.Item1.PageNumber</li>
                                <li>
                                    <i class="fa fa-circle"></i>Loại bìa: @{
                                        Write((Model.Item1.isPaperback) ? "Bìa mềm" : "Bìa cứng");
                                    }
                                </li>
                                <li>
                                    <i class="fa fa-circle"></i>Kích thước: @{
                                        var size = Model.Item1.Width.ToString() + "x" + Model.Item1.Length.ToString();
                                        size += (Model.Item1.Height != null) ? ("x" + Model.Item1.Height.ToString()) : "";
                                        size += " (cm)";
                                        Write(size);
                                    }
                                </li>
                                <li><i class="fa fa-circle"></i>Công ty phát hành: @Model.Item1.MerchantFKNavigation.MerchantCompanyName</li>
                            </ul>
                        </div>
                    </div>
                    <div class="tab-pane" id="Reviews">
                        <div class="valu valu-2">
                            <div class="section-title">
                                <h2>Nhận xét của khách hàng</h2>
                            </div>
                            <div class="product-reviews-summary mt-20 mb-20" style="border-top:none; margin-top:0;">
                                <div class="rating-summary">
                                    <a href="#">@Model.Item1.Rating<i class="fa fa-star"></i></a> trong tổng số @Model.Item1.RatingNumber nhận xét
                                </div>
                            </div>
                            @if (Model.Item1.RatingNumber > 0)
                            {
                                @foreach (var item in Model.Item2)
                                {
                                    <ul>
                                        <li>
                                            <div class="review-left col-lg-12">
                                                <div class="review-details">
                                                    <p class="review-author">Người đăng<a href="#">@item.CustomerFKNavigation.UserBy.FullName</a></p>
                                                    <p class="review-date">Ngày đăng <span>@item.DateCreated</span></p>
                                                </div>
                                            </div>
                                            <div class="review-left col-lg-12" style="margin-top:10px; height:15px;">
                                                <div class="review-rating">
                                                    <div class="rating-result">
                                                        @for (int i = 0; i < item.Rating; i++)
			                                            {
                                                        <a><i class="fa fa-star"></i></a>
			                                            }
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="review-content col-lg-12">
                                                <h4>@item.Comment</h4>
                                            </div>
                                        </li>
                                    </ul>
                                }
                            }
                            else
                            {
                                <div class="mt-20 mb-20" style="border-bottom: 1px solid #e5e5e5; margin: 0; padding: 14px 0 12px; overflow: hidden;">
                                    <span>Chưa có nhận xét cho sản phẩm này</span>
                                </div>
                            }
                            @if (!HttpContextAccessor.HttpContext.Session.Get<Boolean>("IsLogin"))
                            {
                                <div class="review-add">
                                    <h3>Bạn chưa đăng nhập. Hãy <a href="@Url.Action("SignIn", "BeyeuBookstore")">đăng nhập</a> để thêm nhận xét nhé</h3>
                                </div>
                            }
                            else
                            {
                                <div class="review-add">
                                    <h3>Thêm nhận xét của bạn:</h3>
                                </div>
                                <div class="review-field-ratings">
                                    <span>Điểm của bạn <sup>*</sup></span>
                                    <div class="control">
                                        <div class="single-control">
                                            <div class="review-control-vote">
                                                <a href="#"><i class="fa fa-star"></i></a>
                                                <a href="#"><i class="fa fa-star"></i></a>
                                                <a href="#"><i class="fa fa-star"></i></a>
                                                <a href="#"><i class="fa fa-star"></i></a>
                                                <a href="#"><i class="fa fa-star"></i></a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="review-form">
                                    <div class="single-form">
                                        <label>Nhận xét</label>
                                        <form action="#">
                                            <textarea name="massage" cols="10" rows="4"></textarea>
                                        </form>
                                    </div>
                                </div>
                                <div class="review-form-button">
                                    <a href="#">Nhận xét</a>
                                </div>
                            }
                        </div>
                    </div>
                </div>
            </div>
            <!-- product-info-area-end -->
        </div>
        <div class="col-lg-3 col-md-3 col-sm-4 col-xs-12">
            <div class="shop-left">
                <div class="banner-area mb-30">
                    <div class="banner-img-2">
                        <a href="#">
                            <img src="~/beyeubookstore/img/banner/33.jpg" />
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</div>
<!-- product-main-area-end -->
